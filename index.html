<!DOCTYPE html>

<html lang="pt-BR">
    <head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
        <title>Biblioteca - Nome da Instituição</title>
        <link rel="stylesheet" href="style.css">
    </head>
<body>
    <header>
        <h1>Biblioteca</h1>
        <p>Nome da Instituição</p>
    </header>
    <div class="container">
        <div class="search-section">
            <h2>Consulta ao Acervo Bibliográfico</h2>
            <p>Utilize o campo de busca para localizar livros por título, autor ou assunto em nosso acervo.</p>
            <p>Para mais informações sobre empréstimos e disponibilidade, <a href="#" onclick="mostrarContato()" style="color: #1e3a8a; font-weight: 600;">entre em contato conosco</a>.</p>
        </div>
        <input id="searchInput" onkeyup="filterTable()" placeholder="Digite sua busca..." type="text"/>
        <div class="table-container">
            <table id="booksTable">
            <thead>
                <tr>
                    <th>Tombo</th>
                    <th>Título</th>
                    <th>Autor</th>
                    <th>Classificação</th>
                    <th>Assunto</th>
                    <th>Localização</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <tr class="loading">
                    <td colspan="6">Carregando acervo...</td>
                </tr>
            </tbody>
        </table>
    </div><div id="paginacao" style="text-align: center; margin-top: 1rem;"></div>
</div>
<footer>
    <p>© 2025 Nome da Instituição. Todos os direitos reservados.</p>
</footer>
<script>
  let livros = [];
  let paginaAtual = 1;
  const livrosPorPagina = 50;

  function renderTable(data, pagina = 1) {
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    const inicio = (pagina - 1) * livrosPorPagina;
    const fim = inicio + livrosPorPagina;
    const paginaDados = data.slice(inicio, fim);

    if (data.length === 0) {
      tbody.innerHTML = "<tr class='no-results'><td colspan='6'>Nenhum resultado encontrado para os termos de busca informados.</td></tr>";
      document.getElementById("paginacao").innerHTML = "";
      return;
    }

    paginaDados.forEach((livro) => {
      const row = `<tr>
        <td style="text-align: center">${livro.tombo}</td>
        <td>${livro.titulo ?? ''}</td>
        <td>${livro.autor ?? ''}</td>
        <td>${livro.classificacao ?? ''}</td>
        <td>${livro.assunto ?? ''}</td>
        <td style="text-align: center">${livro.localizacao ?? ''}</td>
      </tr>`;
      tbody.innerHTML += row;
    });

    renderPaginacao(data.length, pagina);
  }

  function renderPaginacao(total, pagina) {
    const totalPaginas = Math.ceil(total / livrosPorPagina);
    const paginacao = document.getElementById("paginacao");
    paginacao.innerHTML = "";

    if (totalPaginas <= 1) return;

    const paginaInfo = document.createElement("span");
    paginaInfo.textContent = ` Página ${pagina} de ${totalPaginas} `;
    paginacao.appendChild(paginaInfo);
    paginacao.appendChild(document.createElement("br"));
    paginacao.appendChild(document.createElement("br"));

    if (pagina > 1) {
      const btnAnterior = document.createElement("button");
      btnAnterior.textContent = "← Anterior";
      btnAnterior.onclick = () => renderTable(livrosFiltrados, pagina - 1);
      paginacao.appendChild(btnAnterior);
    }

    if (pagina < totalPaginas) {
      const btnProxima = document.createElement("button");
      btnProxima.textContent = "Próxima →";
      btnProxima.onclick = () => renderTable(livrosFiltrados, pagina + 1);
      paginacao.appendChild(btnProxima);
    }
  }

  let livrosFiltrados = [];

  function filterTable() {
    const input = document.getElementById("searchInput").value.toLowerCase().trim();

    if (input === '') {
      const tbody = document.getElementById("tableBody");
      tbody.innerHTML = "<tr class='no-results'><td colspan='6'>Digite um termo de busca para consultar o acervo.</td></tr>";
      document.getElementById("paginacao").innerHTML = "";
      return;
    }

    livrosFiltrados = livros.filter(livro =>
      (String(livro.titulo ?? '')).toLowerCase().includes(input) ||
      (String(livro.autor ?? '')).toLowerCase().includes(input) ||
      (String(livro.assunto ?? '')).toLowerCase().includes(input)
    );

    paginaAtual = 1;
    renderTable(livrosFiltrados, paginaAtual);
  }

  fetch('livros.json')
    .then(response => response.json())
    .then(data => {
      livros = data;
      livrosFiltrados = livros;
      const tbody = document.getElementById("tableBody");
      tbody.innerHTML = "<tr class='no-results'><td colspan='6'>Digite um termo de busca para consultar o acervo.</td></tr>";
    })
    .catch(error => {
      console.error('Erro ao carregar livros:', error);
      const tbody = document.getElementById("tableBody");
      tbody.innerHTML = "<tr class='no-results'><td colspan='6'>Erro ao carregar o acervo. Tente novamente mais tarde.</td></tr>";
    });

  function mostrarContato() {
    document.getElementById('contatoModal').style.display = 'block';
  }

  function fecharContato() {
    document.getElementById('contatoModal').style.display = 'none';
  }
</script>
<script async data-id="101479870" src="//static.getclicky.com/js"></script>
<div class="modal" id="contatoModal" onclick="fecharContato()">
<div class="modal-content" onclick="event.stopPropagation()" style="text-align: center;">
<span class="close" onclick="fecharContato()">×</span>
<h2>Informações de Contato</h2>
<p style="font-size: 1.1rem; margin-top: 1rem;"><strong>Telefone:</strong> (XX) XXXXX-XXXX</p>
<p style="font-size: 1.1rem;"><strong>E-mail:</strong> <a href="mailto:biblioteca@instituicao.com.br" style="color: #1e3a8a;">biblioteca@instituicao.com.br</a></p>
</div>
</div>
</body>
</html>

